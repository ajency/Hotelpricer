<ion-header class="hidden-xs">

  <ion-navbar no-padding>
		<ion-title>
			<!--<ion-title>Pricer - Competitors</ion-title>-->
			<div class="container">
				<div class="header-main" padding-horizontal>
					<!-- Main Nav tabs -->
					<ul class="nav pri-menu pri-to-nav">
						<li style="Width: 150px;" margin-right class="hidden-xs"><img src="../assets/img/tracker-logo.png" alt=""></li>
						<!--<li class="visible-xs pri-menu__hb"> <ion-icon name="menu"></ion-icon></li>-->
						<!-- <li class="pri-menu__title hasub"><h1>Tracker</h1></li> -->
						<li class="pri-menu__wrap hidden-xs-inline-block">
							<ul class="pri-menu__full">
								<li (click)="navTo('dashboard');"><a>Dashboard</a></li>
								 <li (click)="navTo('import')"><a>Import</a></li> 
								<li (click)="navTo('prices',{'marketplace': 'all'});"><a>Prices</a></li>
								 <li class="active"><a>Competitors</a></li> 
								<!-- <li (click)="navTo('violations');"><a>Violations</a></li> -->
								<!-- <li (click)="navTo('products');"><a>Products</a></li> -->
								<!--<li (click)="navTo('pricingrule');"><a>Pricing Rules</a></li>-->
							</ul>
						</li>
						<logout-popover>
						</logout-popover>
					</ul>
				</div>
			</div>
		</ion-title>
	</ion-navbar>

</ion-header>




<ion-content (click)="hideAllFilters($event)" class="background-bt-grey-xs" (ionScroll)="getContentHeight()">
	<div class="container" padding-horizontal>
		<div class="header-secondary replace-header">
			<ul class="nav pri-menu">
				<li (click)="goBack()" class="visible-xs pri-menu__hb"> <ion-icon name="ios-arrow-back"></ion-icon></li>
				<!-- <li class="pri-menu__title"><h2>Import product details from a CSV</h2></li> -->
				<li class="pri-menu__wrap marketplace-tabs show-white">
					<ul class="pri-menu__full">
						<li [class.active]="marketOptions.all.active"><a (click)="filterMarket(marketOptions.all)">All</a></li>
						<li [class.active]="marketOptions.amazon.active"><a (click)="filterMarket(marketOptions.amazon)" class="marketplaces m-amazon"><span class="m-h"></span></a></li>
						<li [class.active]="marketOptions.flipkart.active"><a (click)="filterMarket(marketOptions.flipkart)" class="marketplaces m-flipkart"><span class="m-h"></span></a></li>
						<li [class.active]="marketOptions.snapdeal.active"><span class="not-allowed text-tooltip"><span class="tooltip-text">Coming Soon</span><a (click)="filterMarket(marketOptions.snapdeal)" class="marketplaces m-snapdeal"><span class="m-h"></span></a></span></li>
						<li [class.active]="marketOptions.paytm.active"><span class="not-allowed text-tooltip"><span class="tooltip-text">Coming Soon</span><a (click)="filterMarket(marketOptions.paytm)" class="marketplaces m-paytm"><span class="m-h"></span></a></span></li>
					</ul>
				</li>

				<!-- <li class="visible-xs"><h5 no-margin="">Competitors</h5></li> -->

				<li class="buttons-right hidden-xs">
					<ul class="pri-menu_full">
						<li>{{firstPageItem}} - {{lastPageItem}} of <strong>{{paginationConfig.totalItems}}</strong></li>
					</ul>
				</li>


			</ul>
		</div>

		<div class="filters flex">
			<div class="filters__search flex">
				<div class="bt-dropdown" [class.open]="filterOptions.search.open">
					<!-- .... On click of this button, add class "open" to the parent div "bt-dropdown" .... -->
					<!-- .... just adding the class will show the dropdown .... -->
					<!-- .... if any of the elements are selected then add class "filtered" to parent div "bt-dropdown" .... -->
					<button ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop btn-search" (click)="toggleDrop('search')">
						<ion-icon name="ios-search"></ion-icon> {{filterOptions.search.selectedname}}  <ion-icon name="ios-arrow-down"></ion-icon>
					</button>
					<div class="bt-dropdown__dd">
						<button ion-button color="dark" (click)="changeSearchField(field.slug)" *ngFor="let field of filterOptions.search.options" clear no-margin block class="bt-dropdown__btn button-drop">{{field.name}}</button>
					</div>
				</div>
				<input [(ngModel)]="filterOptions.search.value" (keyup)="searchItem($event)" type="text" class="form-control" placeholder="Type to search" padding-left>
			</div>
			<!-- .... On click of this button  ... -->
			<!-- .... toggle class "open" here ... -->
			<a (click)="toggleFilterView()" [class.open]="!hideFilter" class="filters__toggle"><img src="../assets/img/filter.png" alt=""></a>
			<!-- .... toggle class "hidden" for this one -->
			<div [class.hidden]="hideFilter" class="filters__wrap flex">
				<div class="bt-dropdown" [class.open]="filterOptions.ratings.open" [class.filtered]="filterOptions.ratings.filtered">
					<button (click)="toggleDrop('ratings')" ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
						<span class="plusicon visible-xs-inline-block"></span> Ratings
							<!--<span [hidden]="!filterOptions.ratings.filtered">&nbsp;({{filterOptions.ratings.min.toLocaleString()}} - {{filterOptions.ratings.max.toLocaleString()}})</span> -->
						<ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
					</button>
					<div class="bt-dropdown__dd range-dd">
						<!--<ion-item>-->
							<!-- .... this range slider stops working when this is added -> dualKnobs="true" .... -->
							<!-- .... please check as it needs to have dual knobs - for max and min .... -->
							<!--<ion-range min="1000" max="2000" color="green">-->
								<!-- <ion-icon range-left small name="sunny"></ion-icon>
								<ion-icon range-right name="sunny"></ion-icon> -->
							<!--</ion-range>-->
						<!--</ion-item>-->
						<!-- <div> -->
							<ion-list class="filter-boxes inline" padding-horizontal>
								<!-- <ion-item class="has-rupee-symbol"> -->
								<ion-item class="">
									<ion-label stacked>Min</ion-label>
									<ion-input min="0" max="5" (keyup.enter)="updateFilter('ratings')" [(ngModel)]="filterOptions.ratings.min" type="number"></ion-input>
								</ion-item>
								<ion-item class="">
									<ion-label stacked>Max</ion-label>
									<ion-input min="0" max="5" (keyup.enter)="updateFilter('ratings')" [(ngModel)]="filterOptions.ratings.max" type="number"></ion-input>
								</ion-item>
							</ion-list>
						<!-- </div> -->
						<div [hidden]="!filterOptions.ratings.error" class="error error--danger">
							Min should be less than Max!
						</div>
						<div style="text-align: center;" padding-horizontal>
							<button ion-button color="green" class="btn-apply" full (click)="updateFilter('ratings')" no-margin>Apply</button>
						</div>
					</div>
				</div>

				<div class="bt-dropdown" [class.open]="filterOptions.reviews.open" [class.filtered]="filterOptions.reviews.filtered">
					<button (click)="toggleDrop('reviews')" ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
						<span class="plusicon visible-xs-inline-block"></span> Reviews
							<!--<span [hidden]="!filterOptions.reviews.filtered">&nbsp;({{filterOptions.reviews.min.toLocaleString()}} - {{filterOptions.reviews.max.toLocaleString()}})</span> -->
						<ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
					</button>
					<div class="bt-dropdown__dd range-dd">
						<!--<ion-item>-->
							<!-- .... this range slider stops working when this is added -> dualKnobs="true" .... -->
							<!-- .... please check as it needs to have dual knobs - for max and min .... -->
							<!--<ion-range min="1000" max="2000" color="green">-->
								<!-- <ion-icon range-left small name="sunny"></ion-icon>
								<ion-icon range-right name="sunny"></ion-icon> -->
							<!--</ion-range>-->
						<!--</ion-item>-->
						<!-- <div> -->
							<ion-list class="filter-boxes inline" padding-horizontal>
								<ion-item class="">
									<ion-label stacked>Min</ion-label>
									<ion-input min="1" (keyup.enter)="updateFilter('reviews')" [(ngModel)]="filterOptions.reviews.min" type="number"></ion-input>
								</ion-item>
								<ion-item class="">
									<ion-label stacked>Max</ion-label>
									<ion-input min="1" (keyup.enter)="updateFilter('reviews')" [(ngModel)]="filterOptions.reviews.max" type="number"></ion-input>
								</ion-item>
							</ion-list>
						<!-- </div> -->
						<div [hidden]="!filterOptions.reviews.error" class="error error--danger">
							Min should be less than Max!
						</div>
						<div style="text-align: center;" padding-horizontal>
							<button ion-button color="green" class="btn-apply" full (click)="updateFilter('reviews')" no-margin>Apply</button>
						</div>
					</div>
				</div>
				<div class="bt-dropdown" [class.open]="filterOptions.listings.open" [class.filtered]="filterOptions.listings.filtered">
					<button (click)="toggleDrop('listings')" ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
						<span class="plusicon visible-xs-inline-block"></span> Listings
							<!--<span [hidden]="!filterOptions.listings.filtered">&nbsp;({{filterOptions.listings.min.toLocaleString()}} - {{filterOptions.listings.max.toLocaleString()}})</span> -->
						<ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
					</button>
					<div class="bt-dropdown__dd range-dd">
						<!--<ion-item>-->
							<!-- .... this range slider stops working when this is added -> dualKnobs="true" .... -->
							<!-- .... please check as it needs to have dual knobs - for max and min .... -->
							<!--<ion-range min="1000" max="2000" color="green">-->
								<!-- <ion-icon range-left small name="sunny"></ion-icon>
								<ion-icon range-right name="sunny"></ion-icon> -->
							<!--</ion-range>-->
						<!--</ion-item>-->
						<!-- <div> -->
							<ion-list class="filter-boxes inline" padding-horizontal>
								<ion-item class="">
									<ion-label stacked>Min</ion-label>
									<ion-input min="1" (keyup.enter)="updateFilter('listings')" [(ngModel)]="filterOptions.listings.min" type="number"></ion-input>
								</ion-item>
								<ion-item class="">
									<ion-label stacked>Max</ion-label>
									<ion-input min="1" (keyup.enter)="updateFilter('listings')" [(ngModel)]="filterOptions.listings.max" type="number"></ion-input>
								</ion-item>
							</ion-list>
						<!-- </div> -->
						<div [hidden]="!filterOptions.listings.error" class="error error--danger">
							Min should be less than Max!
						</div>
						<div style="text-align: center;" padding-horizontal>
							<button ion-button color="green" class="btn-apply" full (click)="updateFilter('listings')" no-margin>Apply</button>
						</div>
					</div>
				</div>
				<!-- <div class="bt-dropdown">

					<button ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
						<span class="plusicon visible-xs-inline-block"></span> Stockouts <ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
					</button>
					<div class="bt-dropdown__dd">
						blah
					</div>
				</div> -->
				<div class="bt-dropdown" [class.open]="filterOptions.sort.open" [class.filtered]="filterOptions.sort.filtered">
					<!-- .... On click of this button, add class "open" to the parent div "bt-dropdown" .... -->
					<!-- .... just adding the class will show the dropdown .... -->
					<button (click)="toggleDrop('sort')" ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
						<span class="plusicon visible-xs-inline-block"></span> Sort by
							<!--<span [hidden]="!filterOptions.sort.selectedname">&nbsp;({{filterOptions.sort.selectedname}})</span>-->
						<ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
					</button>
					<div class="bt-dropdown__dd">
						<ion-list radio-group [(ngModel)]="filterOptions.sort.selected" (ionChange)="updateFilter('sort')">
							<ion-item *ngFor="let item of filterOptions.sort.options">
								<ion-label no-padding>{{item.name}}</ion-label>
								<ion-radio color="green" no-padding value="{{item.slug}}"></ion-radio>
							</ion-item>
						</ion-list>
					</div>
				</div>
				<div class="bt-dropdown" [class.open]="filterOptions.direction.open" [class.filtered]="filterOptions.direction.filtered">
					<!-- .... On click of this button, add class "open" to the parent div "bt-dropdown" .... -->
					<!-- .... just adding the class will show the dropdown .... -->
					<button (click)="toggleDrop('direction')" ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
						<span class="plusicon visible-xs-inline-block"></span> Order
							<!--<span [hidden]="!filterOptions.direction.selectedname">&nbsp;({{filterOptions.direction.selectedname}})</span>-->
						<ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
					</button>
					<div class="bt-dropdown__dd">
						<ion-list radio-group [(ngModel)]="filterOptions.direction.selected" (ionChange)="updateFilter('direction')">
							<ion-item *ngFor="let item of filterOptions.direction.options">
								<ion-label no-padding>{{item.name}}</ion-label>
								<ion-radio color="green" no-padding value="{{item.slug}}"></ion-radio>
							</ion-item>
						</ion-list>
					</div>
				</div>
				<!--<button ion-button color="green" class="btn-apply" no-margin>Apply</button>-->
				<button (click)="resetFilter()" ion-button color="secondary" no-margin class="btn-reset" clear><ion-icon name="md-refresh" class="hidden-xs"></ion-icon><span class="visible-xs">Reset</span></button>
			</div>
		</div>

		<div class="tabular">
			<div class="competitors-theader hidden-xs" [ngClass]="{'scroll-fixed-header': lockMainHeader}">
				<div class="tabular__header flex hidden-xs">
					<div class="tabular__cell cell-1"></div>

					<div class="tabular__cell cell-6">Seller Name</div>

					<div class="flex cell-20">
						<div class="tabular__cell cell-4">Competing</div>
						<div class="tabular__cell cell-4">BuyBox</div>
						<div class="tabular__cell cell-3">FBM</div> <!--21-->
						<div class="tabular__cell cell-4">Lowest on</div>
						<div class="tabular__cell cell-5">MOP violations</div>
						<div class="tabular__cell cell-5">MRP violations</div>
						<!--<div class="tabular__cell cell-3">Stockouts</div>-->
						<div class="tabular__cell cell-4">Tracked Since</div>
					</div>

					<!-- <div class="tabular__cell cell-3">Visual Overview</div> -->


				</div>
			</div>

			<!-- loader -->
			 <div class="tabular__row flex has-anim-loader" [hidden]="competitorList.length || listLoading == false" *ngFor="let dummy of dummyProducts">
				<div class="masked masked--competitors">
					<div class="masked__bg">
						<div class="masked__elements">
							<div class="masked__elem masked--1"></div>
							<div class="masked__elem masked--2"></div>
							<div class="masked__elem masked--3"></div>
							<div class="masked__elem masked--4"></div>
							<div class="masked__elem masked--5"></div>
							<div class="masked__elem masked--6"></div>
							<div class="masked__elem masked--7"></div>
							<div class="masked__elem masked--8"></div>
							<div class="masked__elem masked--9"></div>
							<div class="masked__elem masked--10"></div>
							<div class="masked__elem masked--11"></div>
							<div class="masked__elem masked--12"></div>
							<div class="masked__elem masked--13"></div>
							<div class="masked__elem masked--14"></div>
							<div class="masked__elem masked--15"></div>
							<div class="masked__elem masked--16"></div>
							<div class="masked__elem masked--17"></div>
							<div class="masked__elem masked--18"></div>
							<div class="masked__elem masked--19"></div>
							<div class="masked__elem masked--20"></div>
						</div>
					</div>
				</div>
			</div>

			<!--<div class="tabular__row flex" *ngIf="!listLoading && !competitorList.length" style="justify-content: center;">-->
			<div class="tabular__row flex" [hidden]="listLoading || competitorList.length > 0 || competitorListError" style="justify-content: center;">
				<strong>No records found</strong>
			</div>

			<div class="tabular__row flex" [hidden]="listLoading || competitorList.length > 0 || !competitorListError" style="justify-content: center;">
				<strong>An error occured while loading competitor results!</strong>
			</div>

			<div class="competitors tabular__row flex" text-nowrap *ngFor="let item of competitorList | paginate: paginationConfig">

				<div class="tabular__cell cell-1 market-place_col">
					<div class="text-wrap">
						<span class="marketplaces m-l-0" [ngClass]="{'m-amazon': item.channel_id == '1','m-flipkart': item.channel_id == '2', 'm-snapdeal': item.channel_id == '3', 'm-paytm': item.channel_id == '4'}"><span class="m-h"></span></span>
					</div>
				</div>

				<div class="tabular__cell cell-6 seller-name_col">
					<h6 class="prod-title" no-margin>
						<a target="blank" [href]="item.seller_url" class="">{{item.seller_name || naText}}</a>
					</h6>
					<!-- .... for the amazon like star rating below are the classes .... -->
					<!-- .... 0.0 stars - "star-0_0"   |   0.5 stars - "star-0_5"   |   1.0 stars - "star-1_0" .... -->
					<!-- .... 1.5 stars - "star-1_5"   |   2.0 stars - "star-2_0"   |   2.5 stars - "star-2_5" .... -->
					<!-- .... 3.0 stars - "star-3_0"   |   3.5 stars - "star-3_5"   |   4.0 stars - "star-4_0" .... -->
					<!-- .... 4.5 stars - "star-4_5"   |   5.0 stars - "star-5_0"   |                          .... -->
					<!--<div
						class="amazon-stars inline-elem"
						[ngClass]="{'star-0_0': item.rating == 0 || ( item.rating > 0 && item.rating < 0.5 ) ,'star-0_5': item.rating == 0.5 || ( item.rating > 0.5 && item.rating < 1 ),
									'star-1_0': item.rating == 1 || ( item.rating > 1 && item.rating < 1.5 ), 'star-1_5': item.rating == 1.5 || ( item.rating > 1.5 && item.rating < 2 ),
									'star-2_0': item.rating == 2 || ( item.rating > 2 && item.rating < 2.5 ), 'star-2_5': item.rating == 2.5 || ( item.rating > 2.5 && item.rating < 3 ),
									'star-3_0': item.rating == 3 || ( item.rating > 3 && item.rating < 3.5 ), 'star-3_5': item.rating == 3.5 || ( item.rating > 3.5 && item.rating < 4 ),
									'star-4_0': item.rating == 4 || ( item.rating > 4 && item.rating < 4.5 ), 'star-4_5': item.rating == 4.5 || ( item.rating > 4.5 && item.rating < 5 ),
									'star-5_0': item.rating == 5 || ( item.rating > 5 && item.rating < 5.5 )}"
					>
					</div>-->
					<div class="flex flex-items-center">
						<star-ratings [stars]="item.rating"></star-ratings>
						<!--<span class="text-lighter hidden-xs" padding-left>{{item.rating || naText}}</span>-->
						<span class="text-lighter">{{item.rating || naText}}</span>
					</div>
					<br>
					<span class="text-lighter">( {{item.rating_count ? item.rating_count.toLocaleString() : 'No'}} ratings )</span>
				</div>

				<div class="other_col flex cell-20">
					<div class="tabular__cell cell-4 competing">
						<span class="product-icon"></span>
						<strong class="big">{{item.competes_on >= 0 ? item.competes_on.toLocaleString() : naText}}</strong>
						<br class="visible-xs">
						<small class="visible-xs">Competing</small>
					</div>

					<div class="tabular__cell cell-4 buybox">
						<!--<ion-badge class="bb badge badge-md badge-md-orange" color="orange" text-uppercase="">BB</ion-badge>-->
						<span>{{item.buy_box >= 0 ? item.buy_box.toLocaleString() : naText}}</span>
						<br class="visible-xs">
						<small class="visible-xs">BuyBox</small>
					</div>

					<div class="tabular__cell cell-3 fbm">
						<span>{{item.fbm_listings >= 0 ? item.fbm_listings.toLocaleString() : naText}}</span>
						<br class="visible-xs">
						<small class="visible-xs">FBM</small>
					</div>

					<div class="tabular__cell cell-4 cheapest">
						<span>{{item.cheapest_on >= 0 ? item.cheapest_on.toLocaleString() : naText}}</span>
						<br class="visible-xs">
						<small class="visible-xs">Cheapest</small>
					</div>

					<div (click)="gotoCompProducts(item, 'mop_violation')" [ngClass]="{showPointer: item.mop_violation }" class="tabular__cell cell-5 mop">
						<span class="text-primary">{{item.mop_violation >= 0 ? item.mop_violation.toLocaleString() : naText}}</span>
						<br class="visible-xs">
						<small class="visible-xs">MOP</small>
					</div>

					<div (click)="gotoCompProducts(item, 'mrp_violation')" [ngClass]="{showPointer: item.mrp_violation }" class="tabular__cell cell-5 mrp">
						<span class="text-primary">{{item.mrp_violation >= 0 ? item.mrp_violation.toLocaleString() : naText}}</span>
						<br class="visible-xs">
						<small class="visible-xs">MRP</small>
					</div>

					<!--<div class="tabular__cell cell-3 stockouts">
						<span>78</span>
						<br class="visible-xs">
						<small class="visible-xs">Stockouts</small>
					</div>-->

					<div class="tabular__cell cell-4 tracked-since_col">
						<span class="date">{{item.tracked_since_date || naText}}</span><br>
						<small class="time text-lighter">{{item.tracked_since_time | date:'shortTime'}}</small>
						<br class="visible-xs">
						<small class="visible-xs">Tracked</small>
					</div>
				</div>

				<!-- <div class="tabular__cell cell-3 graph-col">
					<div class="tooltip">
						<pie-chart [dimensions]="40" [pieces]="[{ percent: (item.im_cheaper / item.competes_on) * 100, color: '#accd0e' }]"></pie-chart>
						<div class="tooltip__content direction-left">
							<span [hidden]="item.cheaper_than_me > 0">No listings cheaper than mine</span>
							<span [hidden]="item.cheaper_than_me == 0">
								<span class="big">{{(item.cheaper_than_me / item.competes_on) * 100}}%</span> listings cheaper than mine
							</span>
						</div>
					</div>
				</div> -->


			</div>

			<pagination-controls (pageChange)="pagChanged($event)" autoHide="true"></pagination-controls>
		</div>
	</div>
</ion-content>
<ion-footer>
	<footer-element></footer-element>
</ion-footer>
