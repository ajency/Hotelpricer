<ion-header class="hidden-xs">
   <ion-navbar no-padding>
		<ion-title>
			<!--<ion-title>Pricer - Prices</ion-title>-->
			<div class="container">
        		<div class="header-main" padding-horizontal>
					<!-- Main Nav tabs -->
					<ul class="nav pri-menu pri-to-nav">
						<!--<li (click)="toggleMenu()" class="visible-xs pri-menu__hb"> <ion-icon name="menu"></ion-icon></li>-->
						<li style="Width: 150px;" margin-right class="hidden-xs"><img src="../assets/img/tracker-logo.png" alt=""></li>
						<!-- <li class="pri-menu__title hasub"> --><!-- <h1>Tracker</h1> --><!-- </li> -->
						<li class="pri-menu__wrap hidden-xs-inline-block">
							<ul class="pri-menu__full">
								<!--<li *ngFor="let tab of activeTabsList" (click)="navTo(tab.segment);" [ngClass]="isActive(tab)"><a>{{tab.name}}</a></li>-->
								<li><a (click)="navTo('dashboard');" (contextmenu)="onContextMenu($event,'dashboard')">Dashboard</a></li>
								<li><a (click)="navTo('import')" (contextmenu)="onContextMenu($event,'import')">Import</a></li>  
								<li class="active"><a (contextmenu)="onContextMenu($event,'prices/all')">Prices</a></li>
								<!-- <li (click)="navTo('competitors');"><a>Competitors</a></li>   -->
								<!-- <li (click)="navTo('violations');"><a>Violations</a></li> -->
								<!-- <li (click)="navTo('products');"><a>Products</a></li> -->
								<!--<li (click)="navTo('pricingrule');"><a>Pricing Rules</a></li>-->
							</ul>
						</li>
						<!-- .... user popover will appear here and logout + settings will be a part of it .... -->
						<!--<li (click)="signOut()" class="pri-menu__logout"><a>Logout</a></li>-->
						<logout-popover>
						</logout-popover>
					</ul>
				</div>
			</div>
		</ion-title>
	 </ion-navbar>
</ion-header>
<ion-content (click)="hideAllFilters($event)" class="background-bt-grey-xs">
	<div class="container" padding-horizontal>
		<div class="header-secondary replace-header">
			<ul class="nav pri-menu">
				<li (click)="goBack()" class="visible-xs pri-menu__hb"> <ion-icon name="ios-arrow-back"></ion-icon></li>
				<!-- <li class="pri-menu__title"><h2>Import product details from a CSV</h2></li> -->
				<li class="pri-menu__wrap marketplace-tabs show-white">
					<ul class="pri-menu__full" [hidden]="showFailed || showInactive">
						<li [class.active]="marketOptions.all.active"><a (click)="navTo('prices','all')">All</a></li>
						<li [class.active]="marketOptions.amazon.active"><a (click)="navTo('prices','amazon')" class="marketplaces m-amazon"><span class="m-h"></span></a></li>
						<li [class.active]="marketOptions.flipkart.active"><a (click)="navTo('prices','flipkart')" class="marketplaces m-flipkart"><span class="m-h"></span></a></li>
						<li [class.active]="marketOptions.snapdeal.active"><span class="not-allowed text-tooltip"><span class="tooltip-text">Coming Soon</span><a (click)="navTo('prices','snapdeal')" class="marketplaces m-snapdeal"><span class="m-h"></span></a></span></li>
						<li [class.active]="marketOptions.paytm.active"><span class="not-allowed text-tooltip"><span class="tooltip-text">Coming Soon</span><a (click)="navTo('prices','paytm')" class="marketplaces m-paytm"><span class="m-h"></span></a></span></li>
					</ul>
				<ul class="pri-menu__full" [hidden]="!showFailed">
						<li [class.active]="marketOptions.all.active"><a>Crawl Failed</a></li>
				</ul>
				<ul class="pri-menu__full" [hidden]="!showInactive">
						<li [class.active]="marketOptions.all.active"><a>Inactive Products</a></li>
				</ul>
		</li>

				 <!-- <li class="to-crawl hidden-xs" [hidden]="!pendingCrawls || pendingCrawls < 1">
					<span class="sku-code">
						Products to be crawled: {{pendingCrawls}}
						<span (click)="resetFilters()" class="pending-crawls-refresh">
							&nbsp;Check again
						</span>
					</span>
				</li> -->

    	<li class="to-crawl hidden-xs" [hidden]="!showFailed">
			<span class="sku-code">
			Showing failed products.
			<span (click)="resetFilters()" class="pending-crawls-refresh">
				&nbsp;Exit
			</span>
			</span>
		</li>

		<li class="to-crawl hidden-xs" [hidden]="!showInactive">
			<span class="sku-code">
			Showing inactive products.
			<span (click)="resetFilters()" class="pending-crawls-refresh">
				&nbsp;Exit
			</span>
			</span>
		</li>

		<li class="to-crawl hidden-xs" [hidden]="!firstCrawlFailed || firstCrawlFailed < 1 || showFailed">
					<span class="sku-code">
						<!-- <ion-icon name="ios-repeat"></ion-icon>  -->
						<!-- Crawl failed: {{firstCrawlFailed}} -->
            Some of your products did not crawl.
            <span (click)="getFailedProducts()" class="pending-crawls-refresh">
							&nbsp;Show failed products
						</span>

					</span>
				</li>


				<li class="buttons-right hidden-xs">
					<ul class="pri-menu__full">
						<!-- <li>
							<div class="bt-dropdown open" [class.open]="exportDrop.open">
								<a (click)="toggleExportDrop('sort')">Export <ion-icon name="md-arrow-dropdown" class="vam"></ion-icon></a>
								<div class="bt-dropdown__dd" style="z-index: 100;">
									<ion-list>
										<ion-item (click)="exportFile('all')" style="cursor: pointer;">
											<ion-label no-padding>All Products</ion-label>
										</ion-item>
										<ion-item (click)="exportFile('competing')" style="cursor: pointer;">
											<ion-label no-padding>Competing listings</ion-label>
										</ion-item>
									</ion-list>
								</div>
							</div>
						</li> -->
						<li><a (click)="navTo('import')">Import <ion-icon name="ios-cloud-upload-outline" class="vam"></ion-icon> </a></li> 
						<li class="prices-legend">
							<ion-badge class="bb" color="orange" text-uppercase>BB</ion-badge> BuyBox
						</li>
						<li padding-left>
							<span [hidden]="paginationConfig.totalItems > 0"> - to -- of <strong>---</strong></span>
							<span [hidden]="paginationConfig.totalItems == 0">{{firstPageItem}} to {{lastPageItem}} of <strong>{{paginationConfig.totalItems}}</strong></span>
						</li>
					</ul>
				</li>
			</ul>
		</div>


		<!-- test -->

		<div class="filters flex flex-space-between flex-items-center">
			<!-- crawling -->


			<!-- <div class="to-crawl visible-xs m-t-5" [hidden]="!pendingCrawls || pendingCrawls < 1">
				<span class="sku-code">
					Products to be crawled: {{pendingCrawls}}
					<span (click)="resetFilters()" class="pending-crawls-refresh">
						&nbsp;Check again
					</span>
				</span>
			</div> -->

		<div [hidden]="!topMetrics.last_updated" class="visible-xs center-block m-t-5"><small class="text-md-dark">Last updated at {{topMetrics.last_updated}} </small></div>

		<div class="to-crawl visible-xs m-t-5" [hidden]="!showFailed">
			<span class="sku-code">
				Showing failed products.
				<span (click)="resetFilters()" class="pending-crawls-refresh">
					&nbsp;Exit
				</span>
			</span>
		</div>

	    <div class="to-crawl visible-xs m-t-5" [hidden]="!showInactive">
			<span class="sku-code">
				Showing inactive products.
				<span (click)="resetFilters()" class="pending-crawls-refresh">
					&nbsp;Exit
				</span>
			</span>
		</div>

			<div class="to-crawl visible-xs m-t-5" [hidden]="!firstCrawlFailed || firstCrawlFailed < 1 || showFailed">
				<span class="sku-code">
					<!-- Crawl failed: {{firstCrawlFailed}} -->
          Some of your products did not crawl.
          <span (click)="getFailedProducts()" class="pending-crawls-refresh no-wrap">
						&nbsp;Show failed products
					</span>
				</span>
			</div>

			<!-- /crawling -->
			<div class="status-container" [hidden]="showFailed || showInactive">
				<ul class="">
					<li (click)="filterOptions.pricing_outcome.selected == otcmfilter.slug ? filterOptions.pricing_outcome.selected = '' : filterOptions.pricing_outcome.selected = otcmfilter.slug; updateFilter('pricing_outcome','force');" *ngFor="let otcmfilter of filterOptions.pricing_outcome.options" [class.active]="filterOptions.pricing_outcome.selected == otcmfilter.slug">
						<!-- <a href=""> -->
							<!-- <div><strong>{{ priceListLoading == false && filterOptions.pricing_outcome.selected == otcmfilter.slug ? paginationConfig.totalItems : naText }}</strong></div> -->
							 <span>{{otcmfilter.name}}</span>
						<!-- </a> -->
					</li>
				</ul>
			</div>


			<div class="flex">
				<div class="filters__search flex">
					<div class="bt-dropdown" [class.open]="filterOptions.search.open">
						<!-- .... On click of this button, add class "open" to the parent div "bt-dropdown" .... -->
						<!-- .... just adding the class will show the dropdown .... -->
						<!-- .... if any of the elements are selected then add class "filtered" to parent div "bt-dropdown" .... -->
						<button ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop btn-search" (click)="toggleDrop('search')">
							<ion-icon name="ios-search"></ion-icon> {{filterOptions.search.selectedname}}  <ion-icon name="ios-arrow-down"></ion-icon>
						</button>
						<div class="bt-dropdown__dd">
							<button ion-button color="dark" (click)="changeSearchField(field.slug)" *ngFor="let field of filterOptions.search.options" clear no-margin block class="bt-dropdown__btn button-drop">{{field.name}}</button>
						</div>
					</div>
					<input [(ngModel)]="filterOptions.search.value" #searchBox (keyup)="searchItem($event)" type="text" class="form-control" placeholder="Type to search" padding-left>
				</div>
				<!-- .... On click of this button  ... -->
				<!-- .... toggle class "open" here ... -->
				<a (click)="toggleFilterDisplay()" class="filters__toggle" [class.open]="!hideFilter" [hidden]="showFailed || showInactive"><img src="./assets/img/filter.png" alt=""></a>


				<button [hidden]="!hideFilter || showFailed || showInactive" (click)="resetFilters()" ion-button color="secondary" no-margin class="btn-reset hidden-xs" clear><ion-icon name="md-refresh" class="hidden-xs"></ion-icon><span class="visible-xs">Reset</span></button>
			</div>

			<!-- filters -->
			<!-- .... toggle this one -->
			<div [ngClass]="{'hidden': hideFilter}" class="filters__wrap">
				<!-- <button (click)="resetFilters()" ion-button color="secondary" no-margin class="btn-reset" clear><ion-icon name="md-refresh" class="hidden-xs"></ion-icon><span class="visible-xs">Reset</span></button> -->

				<div class="bt-dropdown" [class.open]="filterOptions.sellers.open" [class.filtered]="filterOptions.sellers.filtered">
					<!-- .... On click of this button, add class "open" to the parent div "bt-dropdown" .... -->
					<!-- .... just adding the class will show the dropdown .... -->
					<button (click)="toggleDrop('sellers')" ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
						<span class="plusicon visible-xs-inline-block"></span> Sellers
							<!--<span [hidden]="!filterOptions.sellers.filtered">&nbsp;({{filterOptions.sellers.min.toLocaleString()}} - {{filterOptions.sellers.max.toLocaleString()}})</span> -->
						<ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
					</button>
					<div class="bt-dropdown__dd range-dd">
						<!--<ion-item>-->
							<!-- .... this range slider stops working when this is added -> dualKnobs="true" .... -->
							<!-- .... please check as it needs to have dual knobs - for max and min .... -->
							<!--<ion-range min="1000" max="2000" color="green">-->
								<!-- <ion-icon range-left small name="sunny"></ion-icon>
								<ion-icon range-right name="sunny"></ion-icon> -->
							<!--</ion-range>-->
						<!--</ion-item>-->
						<!-- <div> -->
							<ion-list class="filter-boxes inline" padding-horizontal>
								<ion-item>
									<ion-label stacked>Min</ion-label>
									<ion-input min="1" (keyup.enter)="updateFilter('sellers')" [(ngModel)]="filterOptions.sellers.min" type="number"></ion-input>
								</ion-item>
								<ion-item>
									<ion-label stacked>Max</ion-label>
									<ion-input min="1" (keyup.enter)="updateFilter('sellers')" [(ngModel)]="filterOptions.sellers.max" type="number"></ion-input>
								</ion-item>
							</ion-list>
						<!-- </div> -->
						<div [hidden]="!filterOptions.sellers.error" class="error error--danger">
							Min should be less than Max!
						</div>
						<div style="text-align: center;" padding-horizontal>
							<button ion-button color="green" class="btn-apply" block (click)="updateFilter('sellers')" no-margin>Apply</button>
						</div>
					</div>
				</div>
				<div class="bt-dropdown" [class.open]="filterOptions.price.open" [class.filtered]="filterOptions.price.filtered">
					<button (click)="toggleDrop('price')" ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
						<span class="plusicon visible-xs-inline-block"></span> My Price
							<!--<span [hidden]="!filterOptions.price.filtered">&nbsp;({{filterOptions.price.min.toLocaleString()}} - {{filterOptions.price.max.toLocaleString()}})</span> -->
						<ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
					</button>
					<div class="bt-dropdown__dd range-dd">
						<!--<ion-item>-->
							<!-- .... this range slider stops working when this is added -> dualKnobs="true" .... -->
							<!-- .... please check as it needs to have dual knobs - for max and min .... -->
							<!--<ion-range min="1000" max="2000" color="green">-->
								<!-- <ion-icon range-left small name="sunny"></ion-icon>
								<ion-icon range-right name="sunny"></ion-icon> -->
							<!--</ion-range>-->
						<!--</ion-item>-->
						<!-- <div> -->
							<ion-list class="filter-boxes inline" padding-horizontal>
								<ion-item class="has-rupee-symbol">
									<ion-label stacked>Min</ion-label>
									<ion-input min="1" (keyup.enter)="updateFilter('price')" [(ngModel)]="filterOptions.price.min" type="number"></ion-input>
								</ion-item>
								<ion-item class="has-rupee-symbol">
									<ion-label stacked>Max</ion-label>
									<ion-input min="1" (keyup.enter)="updateFilter('price')" [(ngModel)]="filterOptions.price.max" type="number"></ion-input>
								</ion-item>
							</ion-list>
						<!-- </div> -->
						<div [hidden]="!filterOptions.price.error" class="error error--danger">
							Min should be less than Max!
						</div>
						<div style="text-align: center;" padding-horizontal>
							<button ion-button color="green" class="btn-apply" full (click)="updateFilter('price')" no-margin>Apply</button>
						</div>
					</div>
				</div>
				<!--<div class="bt-dropdown">
					<button ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
						<span class="plusicon visible-xs-inline-block"></span> Pricing Rule <ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
					</button>
					<div class="bt-dropdown__dd">
						blah
					</div>
				</div>-->
				<!--<div class="bt-dropdown">
					<button ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
						<span class="plusicon visible-xs-inline-block"></span> Last Repriced <ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
					</button>
					<div class="bt-dropdown__dd">
						blah
					</div>
				</div>-->
				<div class="bt-dropdown" [class.open]="filterOptions.sort.open" [class.filtered]="filterOptions.sort.filtered">
					<!-- .... On click of this button, add class "open" to the parent div "bt-dropdown" .... -->
					<!-- .... just adding the class will show the dropdown .... -->
					<button (click)="toggleDrop('sort')" ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
						<span class="plusicon visible-xs-inline-block"></span> Sort by
							<!--<span [hidden]="!filterOptions.sort.selectedname">&nbsp;({{filterOptions.sort.selectedname}})</span>-->
						<ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
					</button>
					<div class="bt-dropdown__dd">
						<ion-list radio-group [(ngModel)]="filterOptions.sort.selected" (ionChange)="updateFilter('sort')">
							<ion-item *ngFor="let item of filterOptions.sort.options">
								<ion-label no-padding>{{item.name}}</ion-label>
								<ion-radio color="green" no-padding value="{{item.slug}}"></ion-radio>
							</ion-item>
						</ion-list>
					</div>
				</div>
				<div class="bt-dropdown" [class.open]="filterOptions.direction.open" [class.filtered]="filterOptions.direction.filtered">
					<!-- .... On click of this button, add class "open" to the parent div "bt-dropdown" .... -->
					<!-- .... just adding the class will show the dropdown .... -->
					<button (click)="toggleDrop('direction')" ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
						<span class="plusicon visible-xs-inline-block"></span> Order
							<!--<span [hidden]="!filterOptions.direction.selectedname">&nbsp;({{filterOptions.direction.selectedname}})</span>-->
						<ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
					</button>
					<div class="bt-dropdown__dd order-dd">
						<ion-list radio-group [(ngModel)]="filterOptions.direction.selected" (ionChange)="updateFilter('direction')">
							<ion-item *ngFor="let item of filterOptions.direction.options">
								<ion-label no-padding>{{item.name}}</ion-label>
								<ion-radio color="green" no-padding value="{{item.slug}}"></ion-radio>
							</ion-item>
						</ion-list>
					</div>
				</div>
				<!--<button ion-button color="green" class="btn-apply" no-margin>Apply</button>-->
				 <button (click)="resetFilters()" ion-button color="secondary" no-margin class="btn-reset" clear><ion-icon name="md-refresh" class="hidden-xs"></ion-icon><span class="visible-xs">Reset</span></button>
			</div>

			<!-- <button [ngClass]="{'visible-xs': !hideFilter}" (click)="resetFilters()" ion-button color="secondary" no-margin class="btn-reset" clear><ion-icon name="md-refresh"></ion-icon><span class="visible-xs">Reset</span></button> -->
			<!-- /filters -->
		</div>
		<!-- /test -->

		<div class="tabular">
			<div class="tabular__header flex hidden-xs">
				<div class="tabular__cell cell-1 t-check">
					<ion-item no-padding>
						<ion-checkbox [disabled]="!isOnline" color="dark" no-padding></ion-checkbox>
					</ion-item>
				</div>
				<div class="tabular__cell cell-7 t-product">Product</div>
				<div class="tabular__cell cell-3 t-price  text-right">My Price</div>
				<!-- <div class="tabular__cell cell-5 t-rule">Pricing Rule</div>  -->
				<div class="tabular__cell cell-7 t-battle text-center"><span class="show-cursor">Price Battlefield <ion-icon (click)="showPBHelper($event)" name="md-help-circle" class="text-lighter"></ion-icon></span></div>
				<!-- <div class="tabular__cell cell-5 t-rule"></div>   -->
				<div class="tabular__cell cell-2 t-listing">Sellers</div>
				<div class="tabular__cell cell-3 t-seller">Mapped Listings</div>
				<div class="tabular__cell cell-5 t-battle text-center"><span class="show-cursor">Price Trend</span></div>
				<div class="tabular__cell cell-2 "></div>
				<!-- show the tooltip on click of this <span> -->
				<!-- <div class="tabular__cell cell-5 t-battle"><span class="show-cursor">Price Battlefield <ion-icon (click)="showPBHelper($event)" name="md-help-circle" class="text-lighter"></ion-icon></span></div> -->
			</div>
			<!-- .... the loader .... -->
			<div class="tabular__row flex has-anim-loader" [hidden]="priceListLoading == false" *ngFor="let dummy of dummyProducts">
				<div class="masked masked--prices">
					<div class="masked__bg">
						<div class="masked__elements">
							<div class="masked__elem masked--1"></div>
							<div class="masked__elem masked--2"></div>
							<div class="masked__elem masked--3"></div>
							<div class="masked__elem masked--4"></div>
							<div class="masked__elem masked--5"></div>
							<div class="masked__elem masked--6"></div>
							<div class="masked__elem masked--7"></div>
							<div class="masked__elem masked--8"></div>
							<div class="masked__elem masked--9"></div>
							<div class="masked__elem masked--10"></div>
							<div class="masked__elem masked--11"></div>
							<div class="masked__elem masked--12"></div>
							<div class="masked__elem masked--13"></div>
							<div class="masked__elem masked--14"></div>
							<div class="masked__elem masked--15"></div>
							<div class="masked__elem masked--16"></div>
						</div>
					</div>
				</div>
			</div>
			<!-- .... add class "violated" to this tabular__row if there's a violation here .... -->
			<!-- .... add class "open" when tapped or clicked .... -->
			<!--<div class="tabular__row flex" *ngIf="!priceListLoading && !productList.length" style="justify-content: center;">-->
			<div class="tabular__row flex" [hidden]="!viewInitialized || priceListLoading || productList.length > 0 || priceListError || ( defaultFiltersOnNoRecords && marketName == 'all' )" style="justify-content: center;">
				<strong>No records found</strong>
			</div>
			<div class="tabular__row flex-column" [hidden]="priceListLoading || productList.length > 0 || priceListError || !defaultFiltersOnNoRecords || marketName != 'all'" style="justify-content: center;">
				<div class="flex-content">
					<strong>
						It takes a few minutes for us to fetch the data for your uploaded products. <span (click)="resetFilters()" class="pending-crawls-refresh">Click here to refresh</span>
					</strong>
				</div>
			</div>

			<div class="tabular__row flex" [hidden]="priceListLoading || productList.length > 0 || !priceListError" style="justify-content: center;">
				<strong>An error occured while loading price results!</strong>
			</div>
			<!--<div class="tabular__row flex" [hidden]="productList.length || priceListLoading == false" style="justify-content: center;">
				<strong>Loading...</strong>
			</div>-->
			<price-row 
				(click)="itemClick($event,item)" 
				(mouseleave)="itemMouseOut(item)" 
				(mouseover)="itemMouseOver(item)" 
				[ngClass]="{'open': item.open, 'violated': item.repricing.violated, 'disabled-row': !item.product_details.in_stock}" 
				[item]="item"
				[loadingpricetrend]="loadingPriceTrend"
				(segmentClicked)="segmentClick(item, editPrFlag)"
				*ngFor="let item of productList | paginate: paginationConfig"
			>
			</price-row>
			<pagination-controls id="productpaging" (pageChange)="pagChanged($event)" autoHide="true"></pagination-controls>
		</div>
	</div>
</ion-content>
<ion-footer>
	<footer-element></footer-element>
</ion-footer>
