 <ion-header class="hidden-xs">
   <ion-navbar no-padding>
		<ion-title>
			<!--<ion-title>Pricer - Import CSV</ion-title>-->
			<div class="container">
        		<div class="header-main" padding-horizontal>
					<!-- Main Nav tabs -->
					<ul class="nav pri-menu pri-to-nav">
						<!--<li (click)="toggleMenu()" class="visible-xs pri-menu__hb"> <ion-icon name="menu"></ion-icon></li>-->
						<li style="Width: 150px;" margin-right class="hidden-xs"><img src="../assets/img/tracker-logo.png" alt=""></li>
						<!-- <li class="pri-menu__title hasub"> <h1>Tracker</h1> </li> -->
						<li class="pri-menu__wrap hidden-xs-inline-block">
							<ul class="pri-menu__full">
								<!--<li *ngFor="let tab of activeTabsList" (click)="navTo(tab.segment);" [ngClass]="isActive(tab)"><a>{{tab.name}}</a></li>-->
								<li><a (click)="navTo('dashboard');" (contextmenu)="onContextMenu($event,'dashboard')">Dashboard</a></li>
								<li class="active"><a (contextmenu)="onContextMenu($event,'import')">Import</a></li>  
								<li><a (click)="navTo('prices','all');" (contextmenu)="onContextMenu($event,'prices/all')">Prices</a></li>
								<!-- <li (click)="navTo('competitors');"><a>Competitors</a></li>   -->
								<!-- <li (click)="navTo('violations');"><a>Violations</a></li> -->
								<!-- <li (click)="navTo('products');"><a>Products</a></li> -->
								<!--<li (click)="navTo('pricingrule');"><a>Pricing Rules</a></li>-->
							</ul>
						</li>
						<!-- .... user popover will appear here and logout + settings will be a part of it .... -->
						<!--<li (click)="signOut()" class="pri-menu__logout"><a>Logout</a></li>-->
						<logout-popover>
						</logout-popover>
					</ul>
				</div>
			</div>
		</ion-title>
	 </ion-navbar>
</ion-header>



<ion-content (click)="hideAllFilters($event)">
	<div class="container" padding-horizontal>
		<div class="header-secondary replace-header">
			<ul class="nav pri-menu">
				<li (click)="goBack()" class="visible-xs pri-menu__hb"> <ion-icon name="ios-arrow-back"></ion-icon></li>
				<li class="pri-menu__title"><h2>Import product details from an XLSX</h2></li>
				<!-- <li class="pri-menu__wrap hidden-xs-inline-block">
					<ul class="pri-menu__full">
						<li class="active"><a  >Summary</a></li>
					</ul>
				</li> -->
			</ul>
		</div>
		<div class="inner-container">
			<div class="info-alert">
				<strong>Upload a list of ASINs/FSNs/SUPCs/ etc listing IDs</strong> in bulk which you want to track. You can <strong>even track listings which you don't actively sell</strong> yourself. You will need to map these to an SKU identifier which will be used to display the info here.
				<br><br class="visible-xs"><hr class="visible-xs"><br>

			</div>
			 <div #customSelect>
				<h6>Choose the marketplace for which you want to upload products</h6>
				 <!-- <div style="text-align: center;">
					<button *ngFor="let market of importMarkets" (click)="selectedMarket = market" ion-button [color]="selectedMarket == market ? 'dark' : 'light'">{{market.name}} <a [hidden]="market.slug == 'all'" margin-left class="marketplaces" [ngClass]="{'m-amazon': market.slug == '1', 'm-flipkart':  market.slug == '2'}" style="transition: none;"><span class="m-h"></span></a></button>
				</div>  -->


				 <!-- <ul id="marketplace-select" tabindex="0" class="">
				  <li class="active">
				  	<div class="flex flex-items-center">Amazon <a margin-left class="marketplaces m-amazon" style="transition: none;"><span class="m-h"></span></a></div>
				  </li>
				  <li class="">
				  	<div class="flex flex-items-center">Flipkart <a margin-left class="marketplaces m-flipkart" style="transition: none;"><span class="m-h"></span></a></div>
				  </li>
				  <li class="">
				  	<div class="flex flex-items-center">Snapdeal<a margin-left class="marketplaces m-snapdeal" style="transition: none;"><span class="m-h"></span></a></div>
				  </li>
				 <li class="">
				  	<div class="flex flex-items-center">Paytm <a margin-left class="marketplaces m-paytm" style="transition: none;"><span class="m-h"></span></a></div>
				  </li>
				</ul>    -->

				<ng-select
					[options]="importMarkets"
					[multiple]="false"
					placeholder="Select a market"
					[allowClear]="false"
					[noFilter]="10"
					(selected)="marketSelected($event)"
				>
					<!-- <ng-template
						#optionTemplate
						let-option="option">
						<span class="you">Test you!</span>
					</ng-template>   -->
				</ng-select>

				<!-- <select [(ngModel)]="selectedMarket">
					<option *ngFor="let market of importMarkets" [ngValue]="market">{{market.name}}</option>
				</select>   -->

				<div *ngIf="selectedMarket.slug == '1'" class="flex flex-space-between flex-wrap">
					<h6>Upload your Amazon Catalog having your product listing IDs</h6>
					<div class="steps-link"><ion-icon  md="md-download" class="text-lighter"></ion-icon>&nbsp;
						<!-- <a href="../assets/pdf/Getting-Amazon-sheet.pdf" target="_blank"><span class="text-success"> Getting Amazon sheet</span> </a> -->
						<a (click)="downloadFile('amazon','amazon_instructions')"><span class="text-success"> Getting Amazon sheet</span> </a>
					</div>
				</div>
				<div *ngIf="selectedMarket.slug == '2'" class="flex flex-space-between flex-wrap">
					<h6>Upload your Flipkart Catalog having your product listing IDs</h6>
					<div class="steps-link"><ion-icon md="md-download" class="text-lighter"></ion-icon>&nbsp;
						<!-- <a href="../assets/pdf/Getting-Flipkart-sheet.pdf" target="_blank"><span class="text-success"> Getting Flipkart sheet</span> </a> -->
						<a (click)="downloadFile('flipkart','flipkart_instructions')"><span class="text-success"> Getting Flipkart sheet</span> </a>
					</div>
				</div>

				<div *ngIf="selectedMarket.slug == 'all'">
					<br/>
					<span class="hidden-xs"><strong>Download</strong> a template <ion-icon name="ios-arrow-forward" class="icon-small" margin-horizontal></ion-icon></span>
					<a (click)="downloadBlankTemplate()" [ngStyle]="{'cursor': 'pointer'}" class="download-link"><ion-icon name="md-arrow-down"></ion-icon> <span class="text-underline">Download a Blank XLSX Template</span></a>
				</div>
				<div *ngIf="selectedMarket.slug == 'all'" class="flex flex-space-between">
					<h6>Upload your Catalog having your product listing IDs</h6>
					<!-- <h6><span class="text-success">see how to get the sheet</span> <ion-icon  md="md-help-circle" class="text-lighter"></ion-icon></h6> -->
				</div>

				<!-- <h6 *ngIf="selectedMarket.slug == '1'">Upload your Amazon Catalog having your product listing IDs</h6> -->
			</div>
			<div [hidden]="!selectedMarket.slug" class="drag-n-drop" [ngClass]="{'show-loader': importingSheet}" margin-vertical>
				<div (click)="showSellerPopover()" [ngClass]="{'disabled-view': importingSheet, 'hidden-view': importingSheet}" style="cursor: pointer;">
					<span class="hidden-xs">
						<strong>
							Click to upload...
						</strong><br>
					</span>
					<span class="visible-xs"><strong>Upload template file...</strong><br></span>

					You can also <strong>Add from Drive</strong> or <strong>Dropbox</strong>&nbsp;
				</div>
			</div>
			<div class="prev-uploads">
				<h4>Previous Uploads</h4>

				<hr>
				
				<div class="success-alert w-dismiss" [ngClass]="{'fadeIn': showFadeIn}" [hidden]="!showAlertSuccess">
					<!-- <span [hidden]="!showIsImport">Your latest sheet of {{ messageVars.no_of_rows }} products is being imported.<br></span>
					<span [hidden]="!showIsCrawling">Your latest sheet of {{ messageVars.no_of_listing }} products is imported of which <strong>{{ messageVars.last_credits_used }}</strong> products are being updated using existing credits -->
					<!-- <span [hidden]="!showIsPartialCrawl">. {{ messageVars.marked_as_inactive }} products have been marked as 
						<a (click)="navTo('prices','all',{'limit': 20, 'page': 1, includesellers: 'no', 'sort': 'created_at', 'direction': 'desc', 'show_inactive': 'yes'})"> inactive products</a></span>.<br>
					</span> -->
					<!-- You currently have <strong>{{ messageVars.credits_remaining }}</strong> product credits remaining. To upgrade your account contact support@browntape.com. -->

					<p>
						Your account supports {{ messageVars.credits || '100' }} products. You are currently tracking 
						 {{messageVars.total_products > 0 ? messageVars.total_products : 0}} 
						 products.<br/>
						To upgrade your account, contact <a target="_blank" href="http://support@browntape.com">support@browntape.com</a>
					</p>

					<p [hidden]="!importSuccess">
						<br/>Successfully imported your sheet containing {{messageVars.no_of_rows > 0 ? messageVars.no_of_rows : 0}} products. 
					</p>

					<p *ngIf="messageVars.marked_as_inactive > 0">
						<br/>You have reached your account limit. Please consider upgrading your account.<br/>
						{{ messageVars.marked_as_inactive }} products have been marked as <a (click)="navTo('prices','all',{'limit': 20, 'page': 1, includesellers: 'no', 'sort': 'created_at', 'direction': 'desc', 'show_inactive': 'yes'})">inactive</a>. 
					</p>

					<div class="dismiss-btn dismiss-alert" (click)="hideAlert(1,messageVars.last_import_id)" >
						<ion-icon name="md-close"></ion-icon>
					</div>
				</div>

				<div class="filters flex">
					<div class="filters__search flex">
						<div class="bt-dropdown" [ngClass]="{open: filterOptions.search.open, filtered: filterOptions.search.filtered}">
							<!-- .... On click of this button, add class "open" to the parent div "bt-dropdown" .... -->
							<!-- .... just adding the class will show the dropdown .... -->
							<!-- .... if any of the elements are selected then add class "filtered" to parent div "bt-dropdown" .... -->
							<button (click)="toggleFileNameDrop()" ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop btn-search">
								<ion-icon name="ios-search"></ion-icon> {{filterOptions.search.selectedname}}  <ion-icon name="ios-arrow-down"></ion-icon>
							</button>
							<div class="bt-dropdown__dd">
								<div (click)="updateSearchType(filefilter.slug)" *ngFor="let filefilter of filterOptions.search.options">
									<!--<button ion-button color="dark" clear no-margin block class="bt-dropdown__btn button-drop" disabled>Filename</button>-->
									<button ion-button color="dark" clear no-margin block class="bt-dropdown__btn button-drop">{{filefilter.name}}</button>
								</div>
							</div>
						</div>
							<!-- <button type="button" class="btn-search">
								 <ion-icon name="ios-search"></ion-icon> Filename  <ion-icon name="ios-arrow-down"></ion-icon>
							</button> -->
						<input [(ngModel)]="filterOptions.search.value" (keyup)="autoSearchUploads($event)" type="text" class="form-control" placeholder="Type to search" padding-left>
					</div>
					<!-- .... On click of this button  ... -->
					<!-- .... toggle class "open" here ... -->
					<a (click)="toggleFilterView()" class="filters__toggle" [class.open]="!hideFilterView"><img src="../assets/img/filter.png" alt=""></a>
					<!-- .... toggle class "hidden" for this one -->
					<div [style.display]="hideFilterView ? 'none' : 'block'" class="filters__wrap">
						<!--<div class="bt-dropdown" [ngClass]="{ open: filterOptions.uploadedBy.open, filtered: filterOptions.uploadedBy.filtered}">
							<button (click)="toggleUploadedByDrop()" ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
								<span class="plusicon visible-xs-inline-block"></span> Uploaded by <ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
							</button>
							<div class="bt-dropdown__dd">
								<ion-item>
									<ion-label no-padding>Show all</ion-label>
									<ion-checkbox color="green" no-padding></ion-checkbox>
								</ion-item>
								<ion-item>
									<ion-label no-padding>Person Name</ion-label>
									<ion-checkbox color="green" no-padding></ion-checkbox>
								</ion-item>
								<ion-item>
									<ion-label no-padding>Person Name</ion-label>
									<ion-checkbox color="green" no-padding></ion-checkbox>
								</ion-item>
							</div>
						</div>-->
						<div class="bt-dropdown filtered" [ngClass]="{open: filterOptions.uploadeOn.open, filtered: filterOptions.uploadeOn.filtered}">
							<!-- .... On click of this button, add class "open" to the parent div "bt-dropdown" .... -->
							<!-- .... just adding the class will show the dropdown .... -->
							<!-- .... if any of the elements are selected then add class "filtered" to parent div "bt-dropdown" .... -->
							<button (click)="toggleUploadedOnDrop()" ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
								<span class="plusicon visible-xs-inline-block"></span> Uploaded on
									<!--<span [hidden]="!filterOptions.uploadeOn.selected">&nbsp;({{filterOptions.uploadeOn.selected}})</span>-->
								<ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
							</button>
							<div class="bt-dropdown__dd has-datepicker">
								<div class="helper-text">
									<strong>Select a date</strong><br>
									<span>to see files uploaded that day</span>
								</div>
								<!-- changing <dp-date-picker> to <dp-day-calendar> gives an inline calendar but doesn't show input field/ better if we can have both -->
								<div class="input-wrap" padding-horizontal>
									<input class="dp-picker-input" theme="dp-material" (ngModelChange)="delayModelUpdate('uploadeOn')" readonly placeholder="Enter date" [(ngModel)]="filterOptions.uploadeOn.selected" [dpDayPicker]="datePickerConfig"/>
								</div>
								<!--<dp-day-calendar theme="dp-material" (ngModelChange)="updateFilter('uploadeOn')" placeholder="Enter date" [(ngModel)]="filterOptions.uploadeOn.selected" [config]="datePickerConfig"></dp-day-calendar>-->
								<!--<dp-month-calendar [(ngModel)]="selectedDate" [config]="datePickerConfig"></dp-month-calendar>-->
							</div>
						</div>
						<div class="bt-dropdown" [ngClass]="{open: filterOptions.status.open, filtered: filterOptions.status.filtered}">
							<button (click)="toggleStatusDrop()" ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
								<span class="plusicon visible-xs-inline-block"></span> Status
									<!--<span [hidden]="!filterOptions.status.selectedname">&nbsp;({{filterOptions.status.selectedname}})</span> -->
								<ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
							</button>
							<div class="bt-dropdown__dd">
								<ion-list radio-group [(ngModel)]="filterOptions.status.selected" (ionChange)="updateFilter('status')">
									<ion-item *ngFor="let item of filterOptions.status.options">
										<ion-label no-padding>{{item.name}}</ion-label>
										<ion-radio color="green" no-padding value="{{item.slug}}"></ion-radio>
									</ion-item>
								</ion-list>
							</div>
						</div>
						<div class="bt-dropdown" [ngClass]="{open: filterOptions.sortBy.open, filtered: filterOptions.sortBy.filtered}">
							<!-- .... On click of this button, add class "open" to the parent div "bt-dropdown" .... -->
							<!-- .... just adding the class will show the dropdown .... -->
							<!-- .... if any of the elements are selected then add class "filtered" to parent div "bt-dropdown" .... -->
							<button (click)="toggleSortByDrop()" ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
								<span class="plusicon visible-xs-inline-block"></span> Sort by
									<!--<span [hidden]="!filterOptions.sortBy.selectedname">&nbsp;({{filterOptions.sortBy.selectedname}})</span> -->
								<ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
							</button>
							<div class="bt-dropdown__dd">
								<ion-list radio-group [(ngModel)]="filterOptions.sortBy.selected" (ionChange)="updateFilter('sortBy')">
									<ion-item *ngFor="let sortoption of filterOptions.sortBy.options">
										<ion-label no-padding>{{sortoption.name}}</ion-label>
										<!--<ion-checkbox color="green" no-padding [(ngModel)]="sortoption.checked" (ionChange)="updateFilter('sortBy')"></ion-checkbox>-->
										<ion-radio color="green" no-padding value="{{sortoption.slug}}"></ion-radio>
									</ion-item>
								</ion-list>
							</div>
						</div>
						<div class="bt-dropdown" [ngClass]="{ open: filterOptions.direction.open, filtered: filterOptions.direction.filtered}">
							<button (click)="toggleDirectionDrop()" ion-button color="dark" outline no-margin class="bt-dropdown__btn button-drop">
								<span class="plusicon visible-xs-inline-block"></span> Direction
									<!--<span [hidden]="!filterOptions.direction.selectedname">&nbsp;({{filterOptions.direction.selectedname}})</span>-->
								<ion-icon name="ios-arrow-down" class="hidden-xs icon-small"></ion-icon>
							</button>
							<div class="bt-dropdown__dd">
								<ion-list radio-group [(ngModel)]="filterOptions.direction.selected" (ionChange)="updateFilter('direction')">
									<ion-item *ngFor="let option of filterOptions.direction.options">
										<ion-label no-padding>{{option.name}}</ion-label>
										<ion-radio color="green" no-padding value="{{option.slug}}"></ion-radio>
									</ion-item>
								</ion-list>
							</div>
						</div>
						<!--<button (click)="applyFilters()" ion-button color="green" class="btn-apply" [ngClass]="{loading: applyFilterFlag}" [disabled]="applyFilterFlag" no-margin>Apply</button>-->
						<button (click)="resetFilters()" ion-button color="secondary" no-margin class="btn-reset" clear><ion-icon name="md-refresh" class="hidden-xs"></ion-icon><span class="visible-xs">Reset</span></button>
						<!-- <a   class="btn btn-primary btn-apply">Apply</a>
						<a   class="btn btn-link btn-reset"><ion-icon name="ios-refresh" class="hidden-xs"></ion-icon><span class="visible-xs">Reset</span></a> -->
					</div>
				</div>
				<!-- 30 cols -->
				<div class="tabular">
					<div class="tabular__header hidden-xs flex">
						<div class="tabular__cell cell-3">Upload ID</div>
						<div class="tabular__cell cell-7">File Name</div>
						<div class="tabular__cell cell-3"></div>
						<div class="tabular__cell cell-5">Uploaded On</div>
						<div class="tabular__cell cell-3">No. of Listings</div>
						<div class="tabular__cell cell-5">Upload Details</div>
						<div class="tabular__cell cell-4"></div>
					</div>
					<!-- .... When the data is loading, every "tabular__row" below has to be replaced with this particular "tabular__row flex has-anim-loader" .... -->
					<!-- .... something like what happens in facebook, when the post is loading, this kind of an animation is present till the post loads .... -->
					<div class="tabular__row flex" [hidden]="!viewInitialized || csvListloading || csvList.length > 0 || csvLoadError" style="justify-content: center;">
						<strong [hidden]="!dummyCleared">No records found</strong>
						<strong [hidden]="dummyCleared">Dummy products will be cleared on uploading new sheet</strong>
					</div>
					<div class="tabular__row flex" [hidden]="!viewInitialized || csvListloading || csvList.length > 0 || !csvLoadError" style="justify-content: center;">
						<strong>Couldn't load results at the moment!</strong>
					</div>
					<div class="tabular__row flex has-anim-loader" [hidden]="csvListloading == false" *ngFor="let dummyitem of dummyCsvList">
						<div class="masked masked--xlsx">
							<div class="masked__bg">
								<div class="masked__elements">
									<div class="masked__elem masked--1"></div>
									<div class="masked__elem masked--2"></div>
									<div class="masked__elem masked--3"></div>
									<div class="masked__elem masked--4"></div>
									<div class="masked__elem masked--5"></div>
									<div class="masked__elem masked--6"></div>
									<div class="masked__elem masked--7"></div>
									<div class="masked__elem masked--8"></div>
									<div class="masked__elem masked--9"></div>
									<div class="masked__elem masked--10"></div>
									<div class="masked__elem masked--11"></div>
									<div class="masked__elem masked--12"></div>
									<div class="masked__elem masked--13"></div>
									<div class="masked__elem masked--14"></div>
								</div>
							</div>
						</div>
					</div>
					<div class="tabular__row flex" *ngFor="let item of csvList | paginate: paginationConfig">
						<div class="tabular__cell cell-3">{{item.id || listNaText}}</div>
						<div class="tabular__cell cell-7">
							<h4 class="file-name text-ellipsis" no-margin title="{{item.file_name || listNaText}}"><strong>{{item.file_name || listNaText}}</strong></h4>
							<span class="uploaded-by text-lighter">{{username || listNaText}}</span>
						</div>
						<div class="tabular__cell cell-3">
							<ion-badge [color]="appservice.setBadgeColor(item.status)">{{item.status || listNaText}}</ion-badge>
						</div>
						<div class="tabular__cell cell-5">{{item.created || listNaText}}</div>
						<div class="tabular__cell cell-7 flex bunched">
							<div class="tabular__cell cell-half cell-42"><strong>{{item.no_of_listing || listNaText}}</strong> <span class="visible-xs-inline-block">Listings</span></div>
							<div class="tabular__cell cell-half cell-58"><span [hidden]="!item.no_of_rows"><span class="bold-xs">{{item.no_of_rows}}</span> <span>rows imported</span></span><span [hidden]="item.no_of_rows">{{listNaText}}</span></div>
						</div>
						<div class="tabular__cell cell-4" text-right>
							<a (click)="downImportedFile(item.id)" padding-right>Download</a>
							<a (click)="showResult(item.id,item.file_name,item.status)">Result</a>
						</div>
					</div>
					<pagination-controls (pageChange)="pagChanged($event)" autoHide="true"></pagination-controls>
				</div>

			</div>
		</div>
	</div>
</ion-content>
<ion-footer>
	<footer-element></footer-element>
</ion-footer>